"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6093],{4137:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>m});var a=t(7294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,a,l=function(e,n){if(null==e)return{};var t,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var i=a.createContext({}),s=function(e){var n=a.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=s(e.components);return a.createElement(i.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,l=e.mdxType,r=e.originalType,i=e.parentName,u=p(e,["components","mdxType","originalType","parentName"]),d=s(t),m=l,k=d["".concat(i,".").concat(m)]||d[m]||c[m]||r;return t?a.createElement(k,o(o({ref:n},u),{},{components:t})):a.createElement(k,o({ref:n},u))}));function m(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var r=t.length,o=new Array(r);o[0]=d;var p={};for(var i in n)hasOwnProperty.call(n,i)&&(p[i]=n[i]);p.originalType=e,p.mdxType="string"==typeof e?e:l,o[1]=p;for(var s=2;s<r;s++)o[s]=t[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},1195:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>o,default:()=>c,frontMatter:()=>r,metadata:()=>p,toc:()=>s});var a=t(7462),l=(t(7294),t(4137));const r={id:"Docker\u5feb\u901f\u642d\u5efaubuntu+swoole\u73af\u5883",title:"Docker\u5feb\u901f\u642d\u5efaubuntu+swoole\u73af\u5883",sidebar_position:5,data:"2022\u5e7410\u670828\u65e5",tags:["php","docker","swoole","ubuntu","nginx"]},o="Docker\u5feb\u901f\u642d\u5efaubuntu+swoole\u73af\u5883",p={unversionedId:"Swoole/Docker\u5feb\u901f\u642d\u5efaubuntu+swoole\u73af\u5883",id:"Swoole/Docker\u5feb\u901f\u642d\u5efaubuntu+swoole\u73af\u5883",title:"Docker\u5feb\u901f\u642d\u5efaubuntu+swoole\u73af\u5883",description:"\u62c9\u53d6ubuntu\u955c\u50cf\u9ed8\u8ba4\u6700\u65b0",source:"@site/wiki/dev/Swoole/5.docker\u642d\u5efaswoole\u73af\u5883.md",sourceDirName:"Swoole",slug:"/Swoole/Docker\u5feb\u901f\u642d\u5efaubuntu+swoole\u73af\u5883",permalink:"/sword-wiki/dev/Swoole/Docker\u5feb\u901f\u642d\u5efaubuntu+swoole\u73af\u5883",draft:!1,tags:[{label:"php",permalink:"/sword-wiki/dev/tags/php"},{label:"docker",permalink:"/sword-wiki/dev/tags/docker"},{label:"swoole",permalink:"/sword-wiki/dev/tags/swoole"},{label:"ubuntu",permalink:"/sword-wiki/dev/tags/ubuntu"},{label:"nginx",permalink:"/sword-wiki/dev/tags/nginx"}],version:"current",lastUpdatedBy:"wxvirus",lastUpdatedAt:1666973205,formattedLastUpdatedAt:"2022\u5e7410\u670828\u65e5",sidebarPosition:5,frontMatter:{id:"Docker\u5feb\u901f\u642d\u5efaubuntu+swoole\u73af\u5883",title:"Docker\u5feb\u901f\u642d\u5efaubuntu+swoole\u73af\u5883",sidebar_position:5,data:"2022\u5e7410\u670828\u65e5",tags:["php","docker","swoole","ubuntu","nginx"]},sidebar:"tutorialSidebar",previous:{title:"swoole\u8fdb\u7a0b\u57fa\u7840\u7ee7\u7eed",permalink:"/sword-wiki/dev/Swoole/swoole\u8fdb\u7a0b\u57fa\u7840\u7ee7\u7eed"},next:{title:"\u534f\u7a0b\u5e76\u53d1\u67e5\u8be2",permalink:"/sword-wiki/dev/Swoole/\u534f\u7a0b\u5e76\u53d1\u67e5\u8be2"}},i={},s=[{value:"\u4fee\u6539nginx\u914d\u7f6e\u6587\u4ef6",id:"\u4fee\u6539nginx\u914d\u7f6e\u6587\u4ef6",level:2},{value:"\u5b89\u88c5swoole",id:"\u5b89\u88c5swoole",level:2}],u={toc:s};function c(e){let{components:n,...t}=e;return(0,l.kt)("wrapper",(0,a.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"docker\u5feb\u901f\u642d\u5efaubuntuswoole\u73af\u5883"},"Docker\u5feb\u901f\u642d\u5efaubuntu+swoole\u73af\u5883"),(0,l.kt)("p",null,"\u62c9\u53d6",(0,l.kt)("inlineCode",{parentName:"p"},"ubuntu"),"\u955c\u50cf\u9ed8\u8ba4\u6700\u65b0"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"docker pull ubuntu\n")),(0,l.kt)("p",null,"\u5728\u672c\u5730\u65b0\u5efa\u4e00\u4e2a\u4e13\u95e8\u5199\u4ee3\u7801\u7684\u76ee\u5f55\uff0c\u7136\u540e\u4e0e\u5bb9\u5668\u8fdb\u884c\u6620\u5c04"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -it -v \u672c\u5730\u76ee\u5f55:/var/www -p 8081:80 -p 9501:9501 --name=ubuntuswoole ubuntu\n")),(0,l.kt)("p",null,"\u8fd0\u884c\u540e\u4f1a\u76f4\u63a5\u8fdb\u5165\u5230\u5bb9\u5668\u5185\u90e8"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u9996\u5148\u66f4\u65b0",(0,l.kt)("inlineCode",{parentName:"p"},"apt"),"\u6e90\uff0c\u5426\u5219\u4f1a\u51fa\u73b0\u627e\u4e0d\u5230\u5b89\u88c5\u5305\u7684\u95ee\u9898"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"apt-get update\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u5b89\u88c5",(0,l.kt)("inlineCode",{parentName:"p"},"nginx")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"apt install -y nginx\n")))),(0,l.kt)("hr",null),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"nginx"),"\u547d\u4ee4"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"# \u5173\u95ed\nservice nginx stop\n# \u5f00\u542f\nservice nginx start\n# \u72b6\u6001\nservice nginx status\n# \u91cd\u542f\nservice nginx restart\n")),(0,l.kt)("hr",null),(0,l.kt)("p",null,"\u5b89\u88c5",(0,l.kt)("inlineCode",{parentName:"p"},"php")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"apt-get install -y software-properties-common\n")),(0,l.kt)("p",null,"\u9009\u62e9\u4e9a\u6d32\uff0c\u4e0a\u6d77\u5730\u533a\u7b49\u5f85\u5b89\u88c5\u5b8c\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"add-apt-repository ppa:ondrej/php\n# \u51fa\u73b0\u77ed\u6682\u6682\u5b9a \u6309\u56de\u8f66\u952e\u3010enter\u3011\u7ee7\u7eed\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"# \u518d\u6b21\u66f4\u65b0\u6e90\napt-get update\n\n# \u5b89\u88c5 php-fpm \u5982\u679c\u662f\u4f7f\u7528swoole \u5176\u5b9efpm\u88c5\u4e0d\u88c5\u65e0\u6240\u8c13\napt-get install -y php7.4-fpm\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"php7.4-fpm"),"\u547d\u4ee4"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"# \u5173\u95ed\nservice php7.4-fpm stop\n# \u5f00\u542f\nservice php7.4-fpm start\n# \u72b6\u6001\nservice php7.4-fpm status\n# \u91cd\u542f\nservice php7.4-fpm restart\n\n")),(0,l.kt)("h2",{id:"\u4fee\u6539nginx\u914d\u7f6e\u6587\u4ef6"},"\u4fee\u6539nginx\u914d\u7f6e\u6587\u4ef6"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"vim /etc/nginx/sites-available/default\n")),(0,l.kt)("p",null,"\u6211\u4eec\u627e\u5230\u5982\u4e0b\u5185\u5bb9"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-nginx"},"root /var/www/html;\n\nindex index.html index.htm index.nginx-debian.html index.php\n")),(0,l.kt)("p",null,"\u5728\u540e\u9762\u52a0\u4e0a",(0,l.kt)("inlineCode",{parentName:"p"},"index.php")),(0,l.kt)("p",null,"\u518d\u627e\u5230\uff1a",(0,l.kt)("inlineCode",{parentName:"p"},"location ~\\.php$"),"\uff0c\u5c06\u5bf9\u5e94\u7684\u6ce8\u91ca\u53bb\u6389"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-nginx"},"location ~\\.php$ {\n    include snippets/fastcgi-php.conf;\n    fastcgi_pass unix:/var/run/php/php7.4-fpm.sock;\n}\n")),(0,l.kt)("p",null,"\u4f7f\u7528",(0,l.kt)("inlineCode",{parentName:"p"},"nginx -t"),"\u68c0\u67e5\u8bed\u6cd5\u662f\u5426\u6b63\u786e\uff0c\u7136\u540e\u91cd\u542f",(0,l.kt)("inlineCode",{parentName:"p"},"nginx"),"\u548c",(0,l.kt)("inlineCode",{parentName:"p"},"fpm")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"# \u91cd\u542f nginx\nservice nginx restart \n# \u542f\u52a8 php7.4-fpm\nservice php7.4-fpm restart \n")),(0,l.kt)("p",null,"\u67e5\u770b\u670d\u52a1\u8fdb\u7a0b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"# \u67e5\u770b\u5f53\u524d\u8fdb\u7a0b\nps -aux\n# \u67e5\u770b nginx \u72b6\u6001\nservice nginx status \n# \u67e5\u770b php7.4-fpm \u72b6\u6001\nservice php7.4-fpm status \n")),(0,l.kt)("p",null,"\u73b0\u5728\u53ef\u4ee5\u5728\u672c\u5730\u6d4f\u89c8\u5668\u4f7f\u7528\u521b\u5efa\u5bb9\u5668\u65f6\u4f7f\u7528\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"8081"),"\u5bf9\u5e94\u5bb9\u5668\u5185\u90e8",(0,l.kt)("inlineCode",{parentName:"p"},"nginx"),"\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"80"),"\u7aef\u53e3\u8bbf\u95ee\u5c31\u53ef\u4ee5\u770b\u5230",(0,l.kt)("inlineCode",{parentName:"p"},"nginx"),"\u7684\u7ecf\u5178\u9875\u9762\u3002"),(0,l.kt)("h2",{id:"\u5b89\u88c5swoole"},"\u5b89\u88c5swoole"),(0,l.kt)("p",null,"\u5148\u5b89\u88c5\u4e00\u4e0b",(0,l.kt)("inlineCode",{parentName:"p"},"wget")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"apt-get install -y wget\n")),(0,l.kt)("p",null,"\u4e0b\u8f7d\u6e90\u7801"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"wget https://github.com/swoole/swoole-src/archive/refs/tags/v4.8.12.tar.gz\n")),(0,l.kt)("p",null,"\u89e3\u538b\u7f29"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"tar -zxvf v4.8.12.tar.gz\ncd swoole-src-xxx\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"phpize && \\\n./configure \\\n--enable-openssl \\\n--enable-http2 && \\\nmake && sudo make install\n")),(0,l.kt)("p",null,"\u6700\u540e\u6210\u529f\u540e\uff0c\u627e\u5230",(0,l.kt)("inlineCode",{parentName:"p"},"php.ini")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"php --ini\n")),(0,l.kt)("p",null,"\u53bb\u5bf9\u5e94\u4f4d\u7f6e\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"ini"),"\u6587\u4ef6\u52a0\u4e0a",(0,l.kt)("inlineCode",{parentName:"p"},"swoole"),"\u914d\u7f6e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ini"},"extension=swoole.so\n")),(0,l.kt)("p",null,"\u9a8c\u8bc1"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"php --ri swoole\nswoole\n\nSwoole => enabled\nAuthor => Swoole Team <team@swoole.com>\nVersion => 4.8.12\nBuilt => Oct 28 2022 23:43:02\ncoroutine => enabled with boost asm context\nepoll => enabled\neventfd => enabled\nsignalfd => enabled\ncpu_affinity => enabled\nspinlock => enabled\nrwlock => enabled\nopenssl => OpenSSL 1.1.1f  31 Mar 2020\ndtls => enabled\nhttp2 => enabled\nmutex_timedlock => enabled\npthread_barrier => enabled\nfutex => enabled\nasync_redis => enabled\n\nDirective => Local Value => Master Value\nswoole.enable_coroutine => On => On\nswoole.enable_library => On => On\nswoole.enable_preemptive_scheduler => Off => Off\nswoole.display_errors => On => On\nswoole.use_shortname => On => On\nswoole.unixsock_buffer_size => 8388608 => 8388608\n")))}c.isMDXComponent=!0}}]);